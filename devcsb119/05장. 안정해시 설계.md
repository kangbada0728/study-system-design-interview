## 안정해시란?
안정해시란, 기존의 전통적인 해시테이블이 가지는 문제점을 해결하기 위해 사용되는 기술이다.

## 전통적인 해시 테이블
전통적인 해시 테이블은 모듈로(%) 연산을 이용하여 키를 분배한다.
이는, 적용대상이 고정되어 있는 경우에는 문제 없지만, 적용 대상이 추가 되거나 삭제 되는 등의 변동이 있는 경우,
대부분의 해시 대상이 재분배 된다.
즉, 수평확장에 취약하다

### 해시 키 재배치
Key 8개와 서버 4대가 있을 때 Key는 2개씩 0, 1, 2, 3에 할당되어 있지만
서버 1대가 장애가 나는 경우, 계산식에서의 N 값이 달라지므로,
모두 새로 해싱되어 해시 키가 재배치된다.
이 경우 장애가 발생한 서버에 보관된 키를 제대로 찾지 못해서 대규모 캐시 미스가 발생하게 된다.

## 안정해시
해시테이블과 다르게, 안정 해시는 해시 테이블 크기가 조정될 때 평균적으로 Key/N(위의 서버 수와 동일)의 키만 재배치하도록 하는 해시 기술이다.
안정 해시는 전통적 해시 테이블과 다르게 모듈로 연산(%)으로 대상을 탐색하지 않으며, Hash Ring을 만들어 링 위에서 첫번째 만나는 것을 대상으로 한다.
안정해시는 크게 두 가지 방법으로 구현할 수 있다.
### 기본 구현법의 문제점
- 해시 파티션의 크기를 균등하게 유지하는게 불가능하다.
- 결국 키가 균등하게 분포되기 어렵다.

### 가상노드를 이용한 구현법의 문제점
가상 노드는 실제 노드 또는 서버를 가리키는 노드로서, 하나의 서버는 링 위에 여러 개의 가상 노드를 가질 수 있다.
가상 노드의 개수를 늘리면 키의 분포는 점점 더 균등해진다.
하지만, 가상노드 데이터를 저장할 공간이 더 많이 필요하고,
각 서버는 하나가 아닌 여러 개 파티션을 관리해야 하므로. 적정한 선을 찾는 것이 중요하다.

### 안정해시의 장점
- 서버가 추가되거나 삭제될 때 재배치되는 키의 수가 최소화된다.
- 데이터가 보다 균등하게 분포하게 되므로 수평적 규모 확장성을 달성하기 쉽다.
- 핫스팟(hotspot) 키 문제를 줄인다.
    - 특정한 샤드에 대한 접근이 지나치게 빈번하면 서버 과부하 문제가 생길 수 있다.
    - 안정 해시는 데이터를 좀 더 균등하게 분배하므로 이런 문제가 생길 가능성을 줄인다.




